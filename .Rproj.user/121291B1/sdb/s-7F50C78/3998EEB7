{
    "contents" : "prot <- \"h3\"\ncategories <- 3\nmodel <- \"weibull\" # weibull or exponential \nem_output <- parse_em_output(prot, model, categories)\nbest <- best_output(em_output)\npath <- file.path(getwd(), \"output\", \"wood_likelihood\", model, prot, names(best), fsep = .Platform$file.sep)\nem_file <-  readLines(path)\nzeroline <- tail(grep('^\\\\s+\\\\[,1\\\\]', em_file,  value = FALSE, perl = TRUE), 1)\nlowpart <- em_file[seq(zeroline+1,length(em_file),1)]\nlastline <- head(grep('^\\\\[1\\\\]', lowpart,  value = FALSE, perl = TRUE), 1)\nrpart <- lowpart[seq(1, lastline-1, 1)]\n\nh3_antigenic_koel = c(161, 171, 172, 174, 175, 205, 209)\ngroup <- h3_antigenic_koel\n\nrvectors <- lapply(rpart, function(row){\n  splittedrow <- unlist(strsplit(row, '\\\\s+'))\n  my_params <- lapply( tail(splittedrow, length(splittedrow)), function(elm){\n    elm\n  }) \n\n})\n\ndf <- data.frame(matrix(unlist(rvectors), nrow=length(rvectors), byrow=T),stringsAsFactors=FALSE)\nrownames(df) <- df[,1]\ndf <- df[,seq(2, ncol(df), 1)]\n\ngroup_pattern <- sapply(group, function (e){\n  paste(c(\"^\", e, \"\\\\.\"), collapse = \"\")\n})\ngrepper <- paste(group_pattern,collapse=\"|\")\ngroup_nodes <- grep(grepper, rownames(df))\ngroup_df <- df[group_nodes,]\n\ncompl_nodes <- !(seq(1,nrow(df),1) %in% group_nodes)\ncompl_df <- df[compl_nodes,]\n\nageing <- sapply(seq(1, categories, 1), function(cat){\n  if (best[[1]]$params[cat,\"p\"] > 1){TRUE} else {FALSE}\n})\n\n\nageing_g <- sum(sapply(group_df[,(ageing)], function(e){sum(as.numeric(e))}))\nadapt_g <- sum(sapply(group_df[,!(ageing)], function(e){sum(as.numeric(e))}))\nageing_c <- sum(sapply(compl_df[,(ageing)], function(e){sum(as.numeric(e))}))\nadapt_c <- sum(sapply(compl_df[,!(ageing)], function(e){sum(as.numeric(e))}))\n\ntbl <- matrix(c(ageing_g, adapt_g, ageing_c, adapt_c), ncol = 2, byrow = TRUE, nrow = 2)\ncolnames(tbl) <- c(\"ageing\", \"adapt\")\nrownames(tbl) <- c(\"group\", \"compl\")\n\nchisq.test(tbl)\n\nbest_output_file <- function (em_output){\n  bics <- sapply(em_output, function (elm){\n    elm$bic\n  })\n  sorted_bics <-sort(bics)\n  good_names <- names(head(sorted_bics, 1))\n  em_output<- em_output[good_names]\n}\n\n\n\n\n\n\n\ntbl <- matrix(c(10.3, 3,12.7,20), ncol = 2, byrow = TRUE, nrow = 2)\nchisq.test(tbl)",
    "created" : 1464356366804.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3053736438",
    "id" : "3998EEB7",
    "lastKnownWriteTime" : 1464364633,
    "path" : "C:/Users/weidewind/workspace/evolike/R/GroupTest.R",
    "project_path" : "R/GroupTest.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}